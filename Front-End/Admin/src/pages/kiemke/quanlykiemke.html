<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Trang chủ Admin</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="../../assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../../assets/vendors/ti-icons/css/themify-icons.css">
    <link rel="stylesheet" href="../../assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="../../assets/vendors/font-awesome/css/font-awesome.min.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="../../assets/css/style.css">
    <!-- End layout styles -->
    <link rel="shortcut icon" href="../../assets/images/favicon.png" />
  </head>
  <body>
    <div class="container-scroller">
      <!-- partial:partials/_navbar.html -->
      <nav class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row" id="navbar-placeholder"></nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar"></nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title"> Basic Tables </h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Tables</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Basic tables</li>
                </ol>
              </nav>
            </div>
            <div class="row">
              <div class="col-lg-6 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Basic Table</h4>
                    <p class="card-description"> Add class <code>.table</code>
                    </p>
                    <table class="table">
                      <thead>
                        <tr>
                          <th>Profile</th>
                          <th>VatNo.</th>
                          <th>Created</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>Jacob</td>
                          <td>53275531</td>
                          <td>12 May 2017</td>
                          <td><label class="badge badge-danger">Pending</label></td>
                        </tr>
                        <tr>
                          <td>Messsy</td>
                          <td>53275532</td>
                          <td>15 May 2017</td>
                          <td><label class="badge badge-warning">In progress</label></td>
                        </tr>
                        <tr>
                          <td>John</td>
                          <td>53275533</td>
                          <td>14 May 2017</td>
                          <td><label class="badge badge-info">Fixed</label></td>
                        </tr>
                        <tr>
                          <td>Peter</td>
                          <td>53275534</td>
                          <td>16 May 2017</td>
                          <td><label class="badge badge-success">Completed</label></td>
                        </tr>
                        <tr>
                          <td>Dave</td>
                          <td>53275535</td>
                          <td>20 May 2017</td>
                          <td><label class="badge badge-warning">In progress</label></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:partials/_footer.html -->
          <footer class="footer" id="footer"></footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <script src="../../assets/js/jquery.cookie.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page -->
    <!-- End custom js for this page -->
    <script>
      const IMAGE_PATH_1 = "/Admin/src/assets/images/nhanVien/";
        const LOGIN_PAGE_URL = "login.html";

        let navbarLoaded = false;
        let sidebarLoaded = false;
        function checkAllLoaded() {
            if (navbarLoaded && sidebarLoaded) {
                checkLoginStatus();
            }
        }
      // Sử dụng Fetch API để nạp _navbar.html vào trang
      fetch("/Admin/src/partials/_navbar.html")
          .then(response => response.text())
          .then(data => {
              document.getElementById("navbar-placeholder").innerHTML = data;
              navbarLoaded = true;
              checkAllLoaded();
          })
          .catch(error => console.error("Lỗi khi tải navbar:", error));
    </script>
    <script>
      fetch("/Admin/src/partials/_sidebar.html")
          .then(response => response.text())
          .then(data => {
              document.getElementById("sidebar").innerHTML = data;
              sidebarLoaded = true;
              checkAllLoaded();
          })
          .catch(error => console.error("Lỗi khi tải navbar:", error));
    </script>
    <script>
      fetch("/Admin/src/partials/_footer.html")
          .then(response => response.text())
          .then(data => {
              document.getElementById("footer").innerHTML = data;
          })
          .catch(error => console.error("Lỗi khi tải navbar:", error));

          function checkLoginStatus() {
            const token = localStorage.getItem('token');
            const hoTen = localStorage.getItem('hoTen');
            const userRole = localStorage.getItem('userRole');
            let hinhAnh = localStorage.getItem('hinhAnh');

            const loginButton = document.getElementById('loginButton');
            const profileDropdown = document.getElementById('profileDropdown');
            const sidebar = document.getElementById('sidebar');

            if (token) {
                loginButton.style.display = 'none';
                profileDropdown.style.display = 'block';

                const navbarHoTen = document.querySelector('#profileDropdown .nav-profile-text p');
                const navbarHinhAnh = document.querySelector('#profileDropdown .nav-profile-img img');

                if (navbarHoTen) {
                    navbarHoTen.textContent = hoTen;
                }
                if (navbarHinhAnh) {
                    if (hinhAnh && !hinhAnh.startsWith('http')) {
                        hinhAnh = `${IMAGE_PATH_1}${hinhAnh}`;
                    }
                    navbarHinhAnh.src = hinhAnh;
                }

                const sidebarHoTen = document.getElementById("sidebar-hoTen");
                const sidebarVaiTro = document.getElementById("sidebar-vaiTro");
                const sidebarHinhAnh = document.getElementById("sidebar-hinhAnh");

                if (sidebarHoTen) {
                    sidebarHoTen.textContent = hoTen;
                }
                if (sidebarVaiTro) {
                    sidebarVaiTro.textContent = userRole;
                }
                if (sidebarHinhAnh) {
                    sidebarHinhAnh.src = hinhAnh;
                }

                if (userRole === 'Nhân viên') {
                    const quanLyNguoiDungLi = Array.from(sidebar.querySelectorAll('li a'))
                        .find(a => a.textContent.trim() === 'Quản lý người dùng')
                        ?.closest('li');

                    if (quanLyNguoiDungLi) {
                        const basicTable = quanLyNguoiDungLi.querySelector('a[href*="basic-table"]');

                        if (basicTable) {
                            basicTable.closest('li').style.display = 'none';
                        }
                    }
                } else if (userRole === 'Quản lý kho') {
                    const quanLyNguoiDungLi = Array.from(sidebar.querySelectorAll('li a'))
                        .find(a => a.textContent.trim() === 'Quản lý người dùng')
                        ?.closest('li');

                    if (quanLyNguoiDungLi) {
                        const basicTable = quanLyNguoiDungLi.querySelector('a[href*="basic-table"]');

                        if (basicTable) {
                            basicTable.closest('li').style.display = 'block';
                        }
                    }
                }

                document.getElementById('logoutButton').addEventListener('click', function () {
                    localStorage.removeItem('token');
                    localStorage.removeItem('userRole');
                    localStorage.removeItem('hoTen');
                    localStorage.removeItem('hinhAnh');
                    localStorage.removeItem('maNV');
                    window.location.href = "/Admin/src/index.html";
                });

            } else {
                window.location.href = LOGIN_PAGE_URL;
            }
        }
    </script>
  </body>
</html>